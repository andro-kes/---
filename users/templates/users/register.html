{% extends "users/base.html" %}

{% block title %}Register{% endblock title %}

{% block button_name %}Register{% endblock button_name %}

{% block form_id %}register-form{% endblock form_id %}
  
{% block script %}
  <script>
    function getCookie(name) {
      let cookieValue = null;
      if (document.cookie && document.cookie !== '') {
          const cookies = document.cookie.split(';');
          for (let i = 0; i < cookies.length; i++) {
              const cookie = cookies[i].trim();
              // Does this cookie string begin with the name we want?
              if (cookie.substring(0, name.length + 1) === (name + '=')) {
                  cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                  break;
              }
          }
      }
      return cookieValue;
    }
    
    const csrftoken = getCookie('csrftoken');
    

    document.getElementById('register-form').addEventListener('submit', function(event) {
      event.preventDefault();

      // Récupérer les données du formulaire
      var username = document.getElementById('username').value;
      var password = document.getElementById('password').value;

      // Envoyer les données au endpoint
      fetch('api/register/', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-CSRFToken': csrftoken,
        },
        body: JSON.stringify({username: username, password: password})
      })
      .then(response => response.json())
      .then(data => {
        console.log(data);
      })
      .catch(error => {
        console.error(error);
      });
    });
  </script>
{% endblock script %}   

